class Joystick{constructor(i,t="rgba(255, 255, 255, 0.17)",s="rgba(255, 255, 255, 0.3)",h=.16*i.width){this.canvasDOM=i,this.canvas=i.getContext("2d"),this.bigColor=t,this.bigSize=this.canvasDOM.width/2-h,this.smallColor=s,this.smallSize=h,this.pos=0,this.clicked=!1,this.drawCircle(this.canvasDOM.width/2,this.canvasDOM.height/2,this.bigSize,this.bigColor),this.drawCircle(this.canvasDOM.width/2,this.canvasDOM.height/2,this.smallSize,this.smallColor),document.addEventListener("mousemove",this.move.bind(this)),i.addEventListener("mousedown",function(i){this.clicked=!0,this.move(i)}.bind(this)),document.addEventListener("mouseup",function(i){this.clicked=!1,this.clear(),this.drawCircle(this.canvasDOM.width/2,this.canvasDOM.height/2,this.bigSize,this.bigColor),this.drawCircle(this.canvasDOM.width/2,this.canvasDOM.height/2,this.smallSize,this.smallColor)}.bind(this)),document.addEventListener("touchmove",this.move.bind(this)),i.addEventListener("touchstart",function(i){this.clicked=!0,this.move(i)}.bind(this)),document.addEventListener("touchend",function(i){this.clicked=!1,this.clear(),this.drawCircle(this.canvasDOM.width/2,this.canvasDOM.height/2,this.bigSize,this.bigColor),this.drawCircle(this.canvasDOM.width/2,this.canvasDOM.height/2,this.smallSize,this.smallColor)}.bind(this))}clear(){this.canvas.clearRect(0,0,this.canvasDOM.width,this.canvasDOM.height)}drawCircle(i,t,s,h){this.canvas.beginPath(),this.canvas.fillStyle=h,this.canvas.arc(i,t,s,0,2*Math.PI),this.canvas.fill()}radians(i){return i*(Math.PI/180)}degrees(i){return i*(180/Math.PI)}move(i){if(1==this.clicked){this.clear(),this.drawCircle(this.canvasDOM.width/2,this.canvasDOM.height/2,this.bigSize,this.bigColor);let t=i.pageX-this.canvasDOM.offsetLeft,s=i.pageY-this.canvasDOM.offsetTop,h=t-this.canvasDOM.width/2,a=s-this.canvasDOM.height/2;if(Math.sqrt(Math.pow(h,2)+Math.pow(a,2))<this.bigSize)this.drawCircle(t,s,this.smallSize,this.smallColor);else{let i=this.bigSize/Math.sqrt(Math.pow(h,2)+Math.pow(a,2)),t=h*i,s=a*i;this.drawCircle(t+this.canvasDOM.width/2,s+this.canvasDOM.height/2,this.smallSize,this.smallColor)}this.pos=h>0?Math.round(this.degrees(Math.asin(Math.sin(this.radians(90))/Math.sqrt(Math.pow(h,2)+Math.pow(a,2))*a))):-1*Math.round(this.degrees(Math.asin(Math.sin(this.radians(90))/Math.sqrt(Math.pow(h,2)+Math.pow(a,2))*a)))+180,this.pos<0&&(this.pos=360+this.pos)}}}